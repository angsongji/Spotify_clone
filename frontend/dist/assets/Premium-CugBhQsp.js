import{w as b,a as v,r as m,m as j,b as y,j as e,x as N,v as k}from"./index-COxCwWZM.js";const w=(o,c,s,n)=>b.post("momo_api/create/",{amount:o,userId:c,duration:s,content:n}),M=[{id:1,price:1e4,duration:3,title:"Gói premium dùng thử",descriptions:["Nghe toàn bộ các bài hát","Xem video âm nhạc","Tải video âm nhạc về máy"]},{id:2,price:32e3,duration:14,title:"Gói premium chill",descriptions:["Nghe toàn bộ các bài hát","Xem video âm nhạc","Tải video âm nhạc về máy"]}],L=()=>{const o=v(t=>t.user.user),[c,s]=m.useState(""),[n,x]=m.useState(""),g=j(),f=y();m.useEffect(()=>{if(n==="success"||n==="fail"){const t=setTimeout(()=>{f("/")},2e3);return()=>clearTimeout(t)}},[n]),m.useEffect(()=>{const t=new URLSearchParams(g.search),i=t.get("orderId"),h=t.get("resultCode");i&&(h==="0"?(async()=>{const d=await N(o.id);console.log("fetchedUser",d),k(d.data.message),x("success"),s("Thanh toán thành công")})():(s("Thanh toán thất bại"),x("fail")))},[g,n]);const p=({title:t,price:i,duration:h,descriptions:u})=>{const d=async()=>{try{const r=await w(i,o.id,h,t),a=r.data,l=r.status;l>=200&&l<300?a.payUrl?(window.location.href=a.payUrl,s("Đang tiến hành thanh toán! Vui lòng quét mã để thanh toán ở trang MoMo vừa được mở!")):s("Không tạo được thanh toán. MoMo không trả về đường dẫn thanh toán."):l>=400&&l<500?(s("Lỗi gửi yêu cầu thanh toán. Vui lòng kiểm tra lại thông tin và thử lại!"),console.error("Lỗi 4xx:",a)):l>=500?(s("Hệ thống thanh toán phía Momo đang gặp sự cố. Vui lòng thử lại sau!"),console.error("Lỗi 5xx:",a)):(s("Đã xảy ra lỗi không xác định."),console.error("Lỗi không xác định:",l,a))}catch(r){console.error("❌ Lỗi fetch MoMo:",r),s("Lỗi khi tạo thanh toán. Không thể kết nối đến hệ thống.")}};return e.jsxs("div",{className:"bg-[var(--light-gray2)] p-5 pb-5 rounded-lg relative text-white w-full",children:[e.jsxs("div",{className:"bg-[var(--main-green)] text-black text-sm font-semibold rounded-br-md px-3 py-1 inline-block absolute top-0 left-0",children:[h," ngày"]}),e.jsxs("div",{className:"mt-5 flex flex-col gap-2 text-left",children:[e.jsx("h2",{className:"text-2xl font-bold ",children:t}),e.jsxs("p",{className:"text-sm text-[var(--main-green)] ",children:[e.jsxs("span",{className:"text-base font-bold",children:[i," đ"]})," dùng trong ",e.jsxs("span",{className:"text-base font-bold",children:[h," ngày"]})]}),e.jsx("ul",{className:"space-y-2 text-[var(--light-gray3)] self-center",children:u.map((r,a)=>e.jsxs("li",{children:["+ ",r]},a))}),e.jsx("button",{onClick:d,className:" self-center cursor-pointer w-fit px-6 py-2 bg-[var(--main-green)] text-white font-semibold rounded-lg hover:bg-green-600",children:"Mua"})]})]})};return e.jsxs("div",{className:"bg-[#141414] text-center text-white ",children:[e.jsxs("div",{className:"pl-5 flex flex-col text-left justify-end  bg-gradient-to-t from-[rgb(20,20,20)]/20 via-[var(--main-green)] to-[rgb(20,20,20)] h-[40vh]",children:[e.jsx("h1",{className:"text-5xl font-bold mb-3 text-white",children:"Khám phá premium"}),e.jsx("p",{className:"text-lg text-[var(--light-gray3)] mb-10",children:"Tận hưởng âm nhạc không bị gián đoạn, cùng nhiều lợi ích khác!"})]}),c==""&&n===""?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center mt-20 mb-32",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Spotify có các gói sau"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Đơn giản và nhanh, chỉ với vài bước đơn giản bạn đã có thể tận hưởng âm nhạc không giới hạn!"})]}),e.jsx("div",{className:" grid grid-cols-3 gap-10 justify-center p-5",children:M.map((t,i)=>e.jsx(p,{title:t.title,price:`${t.price}`,duration:`${t.duration}`,descriptions:t.descriptions},i))})]}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"text-center min-h-[50vh] flex flex-col justify-center items-center",children:n===""?e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Bạn đang trong quá trình thanh toán"}),e.jsx("p",{className:"text-gray-400 text-base",children:c})]}):n==="success"?e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Hoàn tất thanh toán"}),e.jsx("p",{className:"text-gray-400 text-base",children:c}),e.jsx("div",{children:"Đang chuyển hướng bạn về trang chủ....."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Hoàn tất thanh toán"}),e.jsx("p",{className:"text-gray-400 text-base",children:c}),e.jsx("div",{children:"Đang chuyển hướng bạn về trang chủ....."})]})})})]})};export{L as default};
