import{a as _,k as D,r as c,b as H,c as U,u as q,j as s,F as G,p as I,q as O,l as u,t as T,v as y}from"./index-DU8kCWn9.js";import{F as V,u as $}from"./index.esm-BmlTAiR4.js";import{S as J,a as K}from"./SongCard-cIUH_I-Z.js";const Y=()=>{var h,f,b,p,j,k;const N=_(e=>e.music.albums),n=_(e=>e.user.user),{generateLinearGradient:v}=$(),{id:r}=D(),[Q,A]=c.useState("#ffffff"),[S,w]=c.useState("#2A2A2A"),[t,L]=c.useState({}),C=new V,[F,E]=c.useState(!0),M=H(),g=U(),[d,x]=c.useState(!1),{handleListenListSong:P}=q();c.useEffect(()=>{var a;const e=(a=n==null?void 0:n.liked_albums)==null?void 0:a.includes(r);x(e)},[r]),c.useEffect(()=>{(async()=>{var a;try{const i=await O(r);if(i.data.message[0].songs_data=((a=i.data.message[0].songs_data)==null?void 0:a.filter(l=>l.status===1))||[],L(i.data.message[0]),i.data.message[0].image){const l=await C.getColorAsync(i.data.message[0].image);A(l.hex);const o=v(l.hex,.7,.4,180);w(o)}}catch(i){console.error("Lỗi khi tải album:",i)}finally{E(!1)}})()},[r]);const z=async()=>{var i;const e=n.liked_albums_data||[];let a={};if(d?a.liked_albums=((i=n.liked_albums)==null?void 0:i.filter(l=>l!==r))||[]:a.liked_albums=[...n.liked_albums||[],r],Object.keys(a).length>0)try{u.loading({content:"Đang lưu...",key:"update"});const l=await T(n.id,a);if((l==null?void 0:l.status)===200){const o=a.liked_albums;if(d)g(y({...n,liked_albums:o,liked_albums_data:e.filter(m=>m.id!==r)}));else{const m=N.find(B=>B.id===r);m&&g(y({...n,liked_albums:o,liked_albums_data:[...e||[],m]}))}x(!d),u.success({content:"Thành công",key:"update",duration:2})}}catch(l){u.error({content:l.message,key:"update",duration:2})}else u.error("Vui lòng chọn giá trị")};return s.jsx(s.Fragment,{children:F?s.jsx("div",{className:"loader-container min-h-[50vh]",children:s.jsx("span",{className:"loader",children:" "})}):s.jsxs("div",{style:{background:S},children:[s.jsxs("div",{className:"text-white flex gap-8 flex-col md:flex-row md:items-center p-5",children:[s.jsx("img",{loading:"lazy",className:"w-48 h-48 rounded",src:t.image,alt:t.name}),s.jsxs("div",{className:"flex flex-col justify-end  gap-3 h-48",children:[s.jsx("p",{className:"!m-0",children:"Album"}),s.jsx("h1",{className:"text-5xl font-bold  md:text-7xl p-0  !m-0",children:t.name}),s.jsxs("p",{className:"flex items-center gap-2 text-gray-300 text-sm  !m-0 ",children:[s.jsxs("span",{className:'"w-fit flex items-center cursor-pointer  gap-2',children:[s.jsx("img",{loading:"lazy",className:"w-5 rounded-full",src:(h=t.artist_data)==null?void 0:h.avatar,alt:"Spotify Logo"}),s.jsxs("span",{className:"hover:text-white",onClick:()=>M(`/artist/${t.artist_id}`),children:[(f=t.artist_data)==null?void 0:f.name," "]}),s.jsx("span",{children:"•"})]}),s.jsxs("span",{className:"",children:[t.release_date," •"]}),s.jsxs("span",{className:"",children:[((b=t.songs_data)==null?void 0:b.length)!=0?(p=t.songs_data)==null?void 0:p.reduce((e,a)=>e+(a.status!==0&&a.status!==3?1:0),0):"Chưa có"," bài hát"]})]})]})]}),s.jsx("div",{className:"pb-10",children:s.jsx("ul",{children:((j=t.songs_data)==null?void 0:j.length)!=0?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center mx-5 gap-5 py-10",children:[s.jsxs("button",{onClick:()=>P(t.songs_data),className:"bg-green-500 px-6 py-3 rounded-full mr-4 flex items-center cursor-pointer flex gap-2",children:[s.jsx(G,{className:"mr-2"})," Play"]}),n&&s.jsx("button",{className:"text-gray-400 flex items-center cursor-pointer",children:s.jsx(I,{className:"mr-2 text-2xl",color:d?"darkred":"gray",onClick:()=>z()})})]}),s.jsx(J,{}),(k=t.songs_data)==null?void 0:k.map((e,a)=>s.jsx(s.Fragment,{children:e.status!=0&&s.jsx(K,{song:e,index:a},a)}))]}):s.jsx("div",{className:"m-5 text-white",children:"Cùng đón chờ những bài hát sắp ra mắt trong album!"})})})]})})};export{Y as default};
