import{r as s,u as R,j as e,am as E,an as x,f as O,aq as N,D as q,at as M,av as P,l as r,q as U}from"./index-DU8kCWn9.js";import{F as X}from"./Table-BCuqQ00j.js";import"./addEventListener-BwZfSOX1.js";import"./index-OG1Tw0rO.js";import"./Input-IXdDLzkS.js";import"./FileOutlined-B1KecHcr.js";const{Option:b}=x,B=[{value:-1,label:"Tất cả"},{value:0,label:"Riêng tư"},{value:1,label:"Công khai"},{value:3,label:"Chờ duyệt"}],Y=()=>{const[d,w]=s.useState(""),[o,k]=s.useState(-1),[m,u]=s.useState([]),[C,g]=s.useState([]),[f,j]=s.useState({}),[p,h]=s.useState({}),[S,A]=s.useState(!0),{formatTime:V}=R();s.useEffect(()=>{(async()=>{try{const t=await O();u(t.data.message),g(t.data.message)}catch(t){console.error("Lỗi khi tải album:",t)}finally{A(!1)}})()},[]),s.useEffect(()=>{let a=[...m];o!==-1&&(a=a.filter(t=>t.status===o)),d&&(a=a.filter(t=>t.name.toLowerCase().includes(d.toLowerCase()))),g(a)},[o,d,m]);const D=(a,t)=>{a==="detail"?F(t):a==="edit"&&h(t)},_=[{title:"",dataIndex:"image",key:"image",render:a=>e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{loading:"lazy",src:a,alt:"Ảnh album",className:"w-10 h-auto aspect-square rounded-sm object-cover"})})},{title:"Tên album",dataIndex:"name",key:"name"},{title:"Phát hành",dataIndex:"release_date",key:"release_date"},{title:"Nghệ sĩ",dataIndex:"artist_data",key:"artist_data",render:a=>a.name},{title:"Trạng thái",dataIndex:"status",key:"status",render:a=>a===1?e.jsx("span",{className:"text-green-500",children:"Công khai"}):a===3?e.jsx("span",{className:"text-yellow-500",children:"Chờ duyệt"}):e.jsx("span",{className:"text-red-500",children:"Riêng tư"})},{title:"",key:"action",render:a=>e.jsx(q,{menu:{items:[{key:"detail",label:"Xem chi tiết"},{key:"edit",label:"Chỉnh sửa"}],onClick:({key:t})=>D(t,a)},trigger:["click"],children:e.jsx("span",{className:"cursor-pointer",children:e.jsx(M,{className:"text-gray-500 hover:text-[var(--main-green)]"})})})}],F=a=>{(async()=>{try{r.loading({content:"Đang tải chi tiết album...",key:"detail"});const l=await U(a.id);j(l.data.message[0])}catch(l){console.error("Lỗi khi tải video:",l)}finally{r.success({content:"Đã tải xong!",key:"detail",duration:2})}})()},T=({detailAlbum:a})=>{var t;return e.jsx("div",{className:"z-10 fixed top-0 left-0 w-full h-full bg-black/80 flex flex-col items-center justify-center gap-2",children:e.jsxs("div",{className:"flex flex-col gap-2 ",children:[e.jsx(N,{className:" text-white text-3xl cursor-pointer self-end translate-x-[100%]",onClick:()=>j({})}),e.jsxs("div",{className:"bg-[var(--dark-gray)] p-4 rounded-md",children:[e.jsxs("div",{className:"rounded-md shadow-md flex gap-5 items-center mb-5 ",children:[e.jsx("img",{loading:"lazy",src:a.image,alt:"Ảnh album",className:"w-[10vw] h-[10vw] object-cover rounded-md mb-2"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"text-xs",children:a.status===1?e.jsx("span",{className:"text-green-500",children:"Công khai"}):a.status===3?e.jsx("span",{className:"text-yellow-500",children:"Chờ duyệt"}):e.jsx("span",{className:"text-red-500",children:"Riêng tư"})}),e.jsx("h2",{className:"text-xl font-semibold text-white",children:a.name}),e.jsxs("p",{className:"text-sm text-gray-400",children:["Ngày phát hành: ",a.release_date]}),e.jsxs("p",{className:"text-sm text-gray-400",children:["Nghệ sĩ: ",(t=a.artist_data)==null?void 0:t.name]})]})]}),e.jsx("div",{className:"flex flex-col gap-5 w-full justify-center",children:a.songs_data.map((l,n)=>e.jsxs("div",{className:"flex gap-2 items-center justify-between",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{children:n+1}),e.jsx("img",{loading:"lazy",src:l.image,alt:"Ảnh bài hát",className:"w-10 h-10 object-cover rounded-md"}),e.jsx("div",{className:"text-white",children:l.name})]}),e.jsx("div",{children:V(l.duration)})]},n))})]})]})})},z=({album:a})=>{var v;const[t,l]=s.useState(a.status),n=[{value:a.status,label:a.status==3?"Chờ duyệt":a.status==1?"Công khai":"Riêng tư"}];a.status==3&&(n.push({value:0,label:"Riêng tư"}),n.push({value:1,label:"Công khai"})),a.status==1&&n.push({value:0,label:"Riêng tư"}),a.status==0&&n.push({value:1,label:"Công khai"});const I=async()=>{let c={};if(t!=a.status&&(c.status=t),Object.keys(c).length>0)try{const i=await P(a.id,c);(i==null?void 0:i.status)===200?(u(L=>L.map(y=>y.id===a.id?i.data.message:y)),h({}),r.success("Cập nhật album thành công")):r.error(i==null?void 0:i.data.message)}catch(i){console.log(i)}else r.error("Vui lòng chọn giá trị")};return e.jsx("div",{className:"z-10 absolute top-0 left-0 w-full h-full bg-black/80 flex flex-col items-center justify-center gap-2",children:e.jsxs("div",{className:"flex flex-col gap-2 w-fit",children:[e.jsx(N,{className:"text-white text-3xl cursor-pointer self-end translate-x-[100%]",onClick:()=>h({})}),e.jsxs("div",{className:"p-5 bg-[var(--dark-gray)] rounded-md shadow-md w-full h-fit flex flex-col gap-2",children:[e.jsxs("div",{className:"flex gap-5 items-end w-full h-fit",children:[e.jsx("img",{loading:"lazy",src:a.image,alt:"Ảnh album",className:"w-[10vw] h-auto square object-cover rounded-md "}),e.jsxs("div",{className:"text-white flex flex-col gap-2",children:[e.jsx("div",{className:"text-sm",children:t==1?"Công khai":t==0?"Riêng tư":"Chờ duyệt"}),e.jsx("div",{className:"text-3xl font-bold",children:a.name}),e.jsx("div",{className:"text-sm text-gray-400",children:(v=a.artist_data)==null?void 0:v.name}),e.jsx("div",{className:"text-sm text-gray-400",children:a.release_date})]})]}),e.jsxs("div",{className:"flex gap-5 my-5 items-center",children:["Trạng thái:",e.jsx(x,{style:{width:120},onChange:l,defaultValue:t,children:n.map(c=>e.jsx(e.Fragment,{children:c.value!==-1&&e.jsx(b,{value:c.value,children:c.label},c.value)}))})]}),e.jsx("button",{onClick:I,className:"cursor-pointer self-center bg-[var(--light-gray2)] w-fit text-white p-2 rounded-sm my-2",children:"Lưu"})]})]})})};return e.jsx("div",{children:S?e.jsx("div",{className:"loader-container min-h-[50vh] flex justify-center items-center",children:e.jsx("span",{className:"loader",children:" "})}):e.jsxs("div",{className:"flex flex-col gap-7",children:[!!Object.keys(p).length&&e.jsx(z,{album:p}),!!Object.keys(f).length&&e.jsx(T,{detailAlbum:f}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Tên album",className:"bg-[var(--light-gray2)] text-white p-2 rounded-full w-full focus:outline-none placeholder-[var(--light-gray3)] text-sm pl-10",value:d,onChange:a=>w(a.target.value)}),e.jsx(E,{className:"absolute left-2 top-0 translate-x-[50%] translate-y-[50%] text-[var(--light-gray3)]"})]}),e.jsx(x,{style:{width:120},placeholder:"Chọn một mục",onChange:k,defaultValue:o,children:B.map(a=>e.jsx(b,{value:a.value,children:a.label},a.value))})]})}),e.jsx(X,{columns:_,dataSource:C,pagination:{pageSize:6},scrollToFirstRowOnChange:!0,rowKey:"id"})]})})};export{Y as default};
